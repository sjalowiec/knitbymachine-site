<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Skill Builder | Knit by Machine</title>
<style>
  :root{
    --kbm-green:#52682D;
    --kbm-olive:#738C52;
    --kbm-gray:#f6f7f8;
    --kbm-dark:#333;
    --radius:14px;
  }
  *{box-sizing:border-box}
  body{font-family:"Open Sans",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:#fff;color:var(--kbm-dark);margin:0}
  a{color:var(--kbm-olive);text-decoration:none}
  a:hover{text-decoration:underline}
  .container{max-width:980px;margin:0 auto;padding:24px}
  .hero{display:grid;grid-template-columns:1.2fr .8fr;gap:20px;align-items:center;margin:18px 0 8px}
  .hero .title{padding:20px;border-radius:var(--radius);background:linear-gradient(180deg,#fff,var(--kbm-gray));border:1px solid #e7e9eb}
  .hero h1{margin:0 0 6px;color:var(--kbm-green);font-weight:700;letter-spacing:.2px}
  .hero p{margin:6px 0 0;font-size:1.05rem}
  .tagline{font-family:"Shadows Into Light Two",cursive;font-size:1.25rem;color:var(--kbm-olive)}
  .hero .card{border:1px solid #e7e9eb;border-radius:var(--radius);padding:14px;background:#fff}
  .hero .card h3{margin:0 0 10px;color:var(--kbm-green)}
  .checklist{display:flex;flex-wrap:wrap;gap:10px}
  .check-pill{display:flex;gap:8px;align-items:center;padding:10px 12px;border:1px dashed #ccd1d5;border-radius:999px;background:#fff;cursor:pointer}
  .check-pill input{accent-color:var(--kbm-olive)}

  /* Progress header */
  .progress-wrap{display:flex;align-items:center;justify-content:space-between;gap:14px;margin:22px 0}
  .progress-bar{flex:1;height:10px;background:#ebedf0;border-radius:999px;overflow:hidden}
  .progress-bar > span{display:block;height:100%;background:var(--kbm-olive);width:0}
  .progress-stat{min-width:170px;text-align:right;color:#586069;font-size:.95rem}

  /* Steps */
  .steps{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px}
  .step{border:1px solid #e7e9eb;border-radius:var(--radius);background:#fff;display:flex;flex-direction:column;overflow:hidden;position:relative}
  .step header{padding:12px 14px;border-bottom:1px solid #eef0f2;display:flex;justify-content:space-between;align-items:center}
  .step header h3{margin:0;color:var(--kbm-green);font-size:1.05rem}
  .badge{font-size:.72rem;background:var(--kbm-gray);color:#556; padding:4px 8px;border-radius:999px;border:1px solid #e0e3e6}
  .media{aspect-ratio:16/9;background:#e9ecef;display:grid;place-items:center;color:#8a8f95;font-style:italic}
  .media video,.media img{width:100%;height:100%;object-fit:cover}
  .step .body{padding:12px 14px 6px}
  .step .body p{margin:0 0 8px}
  .actions{display:flex;gap:8px;padding:10px 14px 14px}
  .btn{border:1px solid #d5dadf;background:#fff;border-radius:10px;padding:8px 12px;font-weight:600;cursor:pointer}
  .btn.primary{background:var(--kbm-olive);color:#fff;border-color:var(--kbm-olive)}
  .btn.ghost{background:#fff;color:var(--kbm-olive);border-color:var(--kbm-olive)}
  .btn[aria-pressed="true"].primary{background:var(--kbm-green);border-color:var(--kbm-green)}

  /* Tips accordion inside cards */
  details.tip{border-top:1px dashed #e6eaee;margin:0}
  details.tip summary{list-style:none;padding:10px 14px;cursor:pointer;color:#607080}
  details.tip[open] summary{color:#2b3b2b}
  .tip .tip-body{padding:0 14px 12px;color:#485560}

  /* Reflection */
  .reflect{margin:26px 0;border:1px solid #e7e9eb;border-radius:var(--radius);overflow:hidden;background:#fff}
  .reflect header{background:var(--kbm-gray);padding:12px 16px;border-bottom:1px solid #e1e4e8;color:#2b3b2b}
  .reflect .inner{padding:14px}
  textarea{width:100%;min-height:120px;border:1px solid #d8dde3;border-radius:10px;padding:10px;resize:vertical}
  .reactions{display:flex;gap:8px;margin:10px 0}
  .react{border:1px solid #d5dadf;background:#fff;border-radius:999px;padding:6px 10px;cursor:pointer}
  .react[aria-pressed="true"]{background:#eef6ee;border-color:#bcd8bc}

  /* Connections */
  .connections{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:14px;margin:28px 0}
  .card{border:1px solid #e7e9eb;border-radius:var(--radius);background:#fff;overflow:hidden}
  .card .thumb{height:120px;background:#eef2e8}
  .card .pad{padding:12px}
  .card h4{margin:0 0 6px;color:var(--kbm-green)}

  /* Floating Next button */
  .float-next{position:fixed;right:18px;bottom:18px;z-index:9}
  .float-next .btn{box-shadow:0 6px 18px rgba(0,0,0,.12)}

  /* Confetti */
  .confetti{pointer-events:none;position:fixed;inset:0;display:none}
  .confetti.on{display:block}

  /* Modal */
  .modal{position:fixed;inset:0;display:none;place-items:center;background:rgba(0,0,0,.4);padding:20px}
  .modal .sheet{max-width:560px;width:100%;background:#fff;border-radius:16px;overflow:hidden;border:1px solid #e7e9eb}
  .modal header{padding:14px 16px;border-bottom:1px solid #e7e9eb;color:var(--kbm-green);font-weight:700}
  .modal .body{padding:14px 16px}
  .modal .foot{padding:12px 16px;border-top:1px solid #e7e9eb;display:flex;justify-content:flex-end;gap:8px}

  /* Member label (optional) */
  .member-only{display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:999px;background:#fff5e6;border:1px solid #ffd9a6;color:#a56b00;font-size:.78rem}

  @media (max-width:840px){
    .hero{grid-template-columns:1fr}
  }
</style>
</head>
<body>
  <canvas class="confetti" id="confetti"></canvas>
  <div class="container">
    <!-- HERO -->
    <section class="hero" aria-labelledby="sb-title">
      <div class="title">
        <h1 id="sb-title">Loading...</h1>
        <p id="sb-intro"></p>
        <p class="tagline" id="sb-tagline"></p>
        <div style="margin-top:8px">
          <span class="member-only" id="member-badge" aria-label="Members only feature" title="Members only">ðŸ”’ Member benefit: saves your progress</span>
        </div>
      </div>
      <div class="card" aria-labelledby="prep-title">
        <h3 id="prep-title">Before you start</h3>
        <div class="checklist" id="checklist-items">
          <!-- Dynamically populated -->
        </div>
        <div style="margin-top:10px"><button class="btn ghost" id="openChecklist">Open checklist</button></div>
      </div>
    </section>

    <!-- PROGRESS -->
    <div class="progress-wrap" aria-live="polite">
      <div class="progress-bar" aria-label="Progress"><span id="bar"></span></div>
      <div class="progress-stat" id="progress-stat"><strong id="doneCount">0</strong>/0 tried Â· Keep going</div>
    </div>

    <!-- STEPS -->
    <section class="steps" id="steps-container" aria-label="Try it steps">
      <!-- Dynamically populated -->
    </section>

    <!-- REFLECTION -->
    <section class="reflect" aria-labelledby="reflect-title">
      <header><h2 id="reflect-title" style="margin:0">Observe and record</h2></header>
      <div class="inner">
        <div class="reactions" id="reactions-container" role="group" aria-label="Quick reactions">
          <!-- Dynamically populated -->
        </div>
        <textarea id="notes" placeholder="What did you notice?"></textarea>
      </div>
    </section>

    <!-- CONNECTIONS / NEXT -->
    <section aria-labelledby="next-title">
      <h2 id="next-title" style="color:var(--kbm-green)">Next steps</h2>
      <div class="connections" id="next-steps-container">
        <!-- Dynamically populated -->
      </div>
    </section>
  </div>

  <!-- Floating next action -->
  <div class="float-next"><button class="btn primary" id="nextAction">Show next method</button></div>

  <!-- Checklist Modal -->
  <div class="modal" id="checkModal" role="dialog" aria-modal="true" aria-labelledby="checkTitle">
    <div class="sheet">
      <header id="checkTitle">Quick start checklist</header>
      <div class="body" id="checklist-instructions">
        <!-- Dynamically populated -->
      </div>
      <div class="foot">
        <button class="btn" id="closeChecklist">Close</button>
      </div>
    </div>
  </div>

  <!-- Load the skill builder JavaScript -->
  <script src="../../js/skillbuilder.js"></script>
  <script>
    // Initialize the skill builder with data.json
    document.addEventListener('DOMContentLoaded', () => {
      SkillBuilder.init('data.json');
    });
  </script>
</body>
</html>
